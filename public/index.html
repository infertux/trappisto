<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Trappisto - Interactive Block Explorer</title>

    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="description" content="Trappisto - Interactive Block Explorer">
    <meta name="application-name" content="Trappisto">

    <meta property="og:url" content="https://localhost">
    <meta property="og:title" content="Trappisto">
    <meta property="og:description" content="Trappisto - Interactive Block Explorer">
    <meta property="og:image" content="https://localhost/assets/images/logo.png">

    <link rel="icon" href="assets/images/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/favicon/apple-touch-icon.png">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/open-iconic/font/css/open-iconic-bootstrap.min.css">

    <script src="assets/js/elm.min.js" async defer></script>

    <style>
      /* inconsolata-regular - latin */
      @font-face {
        font-family: 'Inconsolata';
        font-style: normal;
        font-weight: 400;
        src: local('Inconsolata Regular'), local('Inconsolata-Regular'),
             url('assets/fonts/inconsolata-v15-latin-regular.woff2') format('woff2');
      }

      body {
        font-family: 'Inconsolata', monospace;
        font-size: 1.25rem;
      }

      hr {
        border-color: #FFF;
      }

      code {
        display: block;
        font-size: 50%;
        word-break: break-all;
      }

      .bg-black {
        background-color: #000;
      }

      .glow {
        transition: all 1s;
        background: orange;
        box-shadow: 0 0 10px 5px orange;
      }
    </style>
  </head>
  <body class="bg-black text-white">
  <script>
    window.onerror = function(msg, url, line) {
      alert('Oops, a JavaScript error occured, please send a screenshot to the website administrator.\nMessage: ' + msg + '\nURL: ' + url + '\nLine: ' + line);
      return false;
    };
  </script>

  <div class="container-fluid">
    <div class="row" style="position:absolute;width:100%;height:100%">
      <div class="col">
        <div id="particles-js"></div>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <div id="elm-app">Loading...</div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

  <script>
    //particlesJS.load('particles-js', 'assets/js/particles.json', function() {
    //  console.log('callback - particles.js config loaded');
    //});

    window.addEventListener('load', () => {
      const elmAppDiv = document.querySelector('#elm-app');
      const elmApp = Elm.Trappisto.embed(elmAppDiv, { coin: 'BTC' });

      elmApp.ports.elmToJs.subscribe((command) => {
        console.log('Received command: ' + command);

        switch (command) {
          case 'focus':
            const query = document.getElementById('query');
            if (query) {
              query.focus();
              setTimeout(function () { query.select(); }, 50); // delay sightly to allow focus to "stick" before selecting
            }
            break;

          default:
            console.error('Unhandled command: ' + command);
        }
      });

      // Hook {Ctrl,Cmd}+F to our search bar
      // XXX: not done in Elm because we cannot call preventDefault() in Elm
      window.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && (String.fromCharCode(e.which).toLowerCase() === 'f')) {
          e.preventDefault();
          document.querySelector('#query').select();
        }
      });

      // Prefill search bar with URL query part
      // const filter = utils.getParameterByName("filter") || "";
      // elmUserListApp.ports.jsEvents.send(["UserList.Search", filter]);

      // Fetch more results when we scroll to the bottom
      // $(window).scroll(function() {
      //   if($(window).scrollTop() + $(window).height() == $(document).height()) {
      //     elmUserListApp.ports.jsToElm.send(["UserList.Fetch"]);
      //   }
      // });

      // const logo = document.getElementById('logo');
      // logo.classList.add('glow');
      // setTimeout(() => { logo.classList.remove('glow'); }, 1000);
    });
  </script>
  </body>
</html>
